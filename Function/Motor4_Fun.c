/***************************************************************************************************
*FileName:
*Description:
*Author: xsx_kair
*Data:
***************************************************************************************************/

/***************************************************************************************************/
/******************************************Header List********************************************/
/***************************************************************************************************/
#include	"Motor4_Fun.h"

#include	"Motor4_Driver.h"
#include	"Timer3_Driver.h"

#include	"Delay.h"

#include 	"FreeRTOS.h"
#include 	"task.h"
#include 	"queue.h"
#include	"semphr.h"

#include	<string.h>
#include	"stdio.h"
#include 	"stdlib.h"
/***************************************************************************************************/
/***************************************************************************************************/
/***************************************************************************************************/
static Motor * motor4 = NULL;
/***************************************************************************************************/
/***************************************************************************************************/
/***************************************************************************************************/

/***************************************************************************************************/
/***************************************************************************************************/
/***************************************************************************************************/
/****************************************File Start*************************************************/
/***************************************************************************************************/
/***************************************************************************************************/

void motor4MoveTo(unsigned short location, unsigned short waitTime)
{
	motor4 = getMotor(Motor_4);
	
	//¶¨Î»
	if(location == 0)
		motor4->motorLocation = 60000;

	if(motor4->motorLocation == location)
		return;
	else if(motor4->motorLocation > location)
		motor4->isFront = false;
	else
		motor4->isFront = true;

	if(motor4->isFront)
		setMotor4DirGPIO(ON);
	else
		setMotor4DirGPIO(OFF);
	delay_ms(5);
	
	motor4->periodCnt = 0;
	motor4->motorTargetLocation = location;
	motor4->moveStepNum = 65000;
	
	while(waitTime-- && (motor4->motorLocation != motor4->motorTargetLocation))
	{
		vTaskDelay(1 / portTICK_RATE_MS);
	}
}

/****************************************end of file************************************************/

