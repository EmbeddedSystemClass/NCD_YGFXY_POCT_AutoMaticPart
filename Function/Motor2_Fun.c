/***************************************************************************************************
*FileName:
*Description:
*Author: xsx_kair
*Data:
***************************************************************************************************/

/***************************************************************************************************/
/******************************************Header List********************************************/
/***************************************************************************************************/
#include	"Motor2_Fun.h"

#include	"Motor2_Driver.h"
#include	"Timer3_Driver.h"

#include	"Motor_Data.h"
#include	"Motor.h"

#include	"Delay.h"

#include 	"FreeRTOS.h"
#include 	"task.h"
#include 	"queue.h"
#include	"semphr.h"

#include	<string.h>
#include	"stdio.h"
#include 	"stdlib.h"
/***************************************************************************************************/
/***************************************************************************************************/
/***************************************************************************************************/
static Motor * motor2 = NULL;
/***************************************************************************************************/
/***************************************************************************************************/
/***************************************************************************************************/

/***************************************************************************************************/
/***************************************************************************************************/
/***************************************************************************************************/
/****************************************File Start*************************************************/
/***************************************************************************************************/
/***************************************************************************************************/

void motor2MoveTo(unsigned short location, bool isWait)
{
	motor2 = getMotor(Motor_2);

	//¶¨Î»
	if(location == 0)
		motor2->motorLocation = 60000;
	
	if(motor2->motorLocation == location)
		return;
	else if(motor2->motorLocation > location)
		motor2->isFront = false;
	else
		motor2->isFront = true;

	if(motor2->isFront)
		setMotor2DirGPIO(ON);
	else
		setMotor2DirGPIO(OFF);
	delay_ms(5);
	
	motor2->periodCnt = 0;
	motor2->motorTargetLocation = location;
	motor2->moveStepNum = 65000;
	
	while(isWait && motor2->motorLocation != motor2->motorTargetLocation)
	{
		vTaskDelay(1 / portTICK_RATE_MS);
	}
}

/****************************************end of file************************************************/

